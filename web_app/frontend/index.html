<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>IDIL470 PROJET PAPYRUS</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&family=IBM+Plex+Sans:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/app.css?v=20260215-5" />
  </head>
  <body>
    <main class="page">
      <header class="hero">
        <img src="/assets/logo_hachette_livre.png" alt="Logo Hachette Livre" class="hero-logo" />
        <div>
          <h1>IDIL470 PROJET PAPYRUS</h1>
          <p class="hero-subtitle">Extraction Fichier Mainframe</p>
        </div>
      </header>

      <section class="panel">
        <h2>Lancer un traitement</h2>
        <p class="hint">Selectionnez le type de flux puis le fichier. Le mapping est calcule automatiquement depuis IDP470RA selon le contexte metier.</p>
        <form id="jobForm" class="job-form">
          <div class="form-row">
            <div>
              <label for="flowType" class="file-label">Type de flux</label>
              <select id="flowType" name="flowType" required></select>
            </div>
            <div>
              <label for="fileName" class="file-label">Fichier logique</label>
              <select id="fileName" name="fileName" required></select>
            </div>
          </div>
          <label for="dataFile" id="dataFileLabel" class="file-label">Charger le fichier (obligatoire)</label>
          <input id="dataFile" name="dataFile" type="file" accept=".txt,.dat" required />
          <button id="launchBtn" type="submit">Extraction Excel/PDF</button>
        </form>
        <p id="profileContext" class="hint profile-context"></p>
        <p id="errorBox" class="error hidden"></p>
      </section>

      <section id="statusPanel" class="panel status-panel" data-state="queued">
        <div class="status-head">
          <h2>Statut du traitement</h2>
          <span id="statusBadge" class="status-badge is-queued">En attente</span>
        </div>
        <div class="status-grid">
          <article class="status-card">
            <span class="label">Job ID</span>
            <p id="jobIdValue" class="status-value status-code">-</p>
          </article>
          <article class="status-card">
            <span class="label">Statut</span>
            <p id="statusValue" class="status-value">En attente</p>
            <p id="updatedAtValue" class="status-meta">Derniere mise a jour: -</p>
          </article>
          <article class="status-card status-card-wide">
            <span class="label">Message</span>
            <p id="messageValue" class="status-value">Aucun traitement en cours.</p>
          </article>
          <article class="status-card status-card-wide">
            <div class="progress-head">
              <span class="label">Progression</span>
              <span id="progressValue" class="progress-value">0%</span>
            </div>
            <div id="progressWrap" class="progress-wrap">
              <div id="progressBar" class="progress-bar"></div>
            </div>
          </article>
        </div>
        <div id="warningBox" class="warning-list hidden"></div>
      </section>

      <section class="panel">
        <h2>Indicateurs</h2>
        <div class="kpi-grid">
          <article class="kpi-card">
            <h3 id="kpiLabel1">Indicateur 1</h3>
            <p id="kpiValue1">0</p>
          </article>
          <article class="kpi-card">
            <h3 id="kpiLabel2">Indicateur 2</h3>
            <p id="kpiValue2">0</p>
          </article>
          <article class="kpi-card">
            <h3 id="kpiLabel3">Indicateur 3</h3>
            <p id="kpiValue3">0</p>
          </article>
        </div>
      </section>

      <section class="panel">
        <h2>Telechargements</h2>
        <div class="downloads">
          <a id="downloadExcel" class="dl-btn disabled" href="#" aria-disabled="true">Excel</a>
          <a id="downloadPdfFactures" class="dl-btn disabled" href="#" aria-disabled="true">PDF Factures</a>
          <a id="downloadPdfSynthese" class="dl-btn disabled" href="#" aria-disabled="true">PDF Synthese</a>
        </div>
      </section>
    </main>
    <script src="/app.js?v=20260215-5"></script>
  </body>
</html>
