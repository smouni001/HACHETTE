<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>IDIL PAPYRUS FACTURE DEMAT - Web</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&family=IBM+Plex+Sans:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/app.css?v=20260215-1" />
  </head>
  <body>
    <main class="page">
      <header class="hero">
        <img src="/assets/logo_hachette_livre.png" alt="Logo Hachette Livre" class="hero-logo" />
        <div>
          <p class="hero-kicker">Version Web</p>
          <h1>IDIL PAPYRUS FACTURE DEMAT</h1>
          <p class="hero-subtitle">Extraction Mainframe vers Excel/PDF</p>
        </div>
      </header>

      <section class="panel">
        <h2>Lancer un traitement FACDEMA</h2>
        <p class="hint">Le programme source utilise automatiquement IDP470RA. Chargez uniquement le fichier FACDEMA.</p>
        <form id="jobForm" class="job-form">
          <label for="facdemaFile" class="file-label">Fichier FACDEMA (.txt / .dat)</label>
          <input id="facdemaFile" name="facdemaFile" type="file" accept=".txt,.dat" required />
          <button id="launchBtn" type="submit">Extraction Excel/PDF</button>
        </form>
        <p id="errorBox" class="error hidden"></p>
      </section>

      <section id="statusPanel" class="panel status-panel" data-state="queued">
        <div class="status-head">
          <h2>Statut du traitement</h2>
          <span id="statusBadge" class="status-badge is-queued">En attente</span>
        </div>
        <div class="status-grid">
          <article class="status-card">
            <span class="label">Job ID</span>
            <p id="jobIdValue" class="status-value status-code">-</p>
          </article>
          <article class="status-card">
            <span class="label">Statut</span>
            <p id="statusValue" class="status-value">En attente</p>
            <p id="updatedAtValue" class="status-meta">Derniere mise a jour: -</p>
          </article>
          <article class="status-card status-card-wide">
            <span class="label">Message</span>
            <p id="messageValue" class="status-value">Aucun traitement en cours.</p>
          </article>
          <article class="status-card status-card-wide">
            <div class="progress-head">
              <span class="label">Progression</span>
              <span id="progressValue" class="progress-value">0%</span>
            </div>
            <div id="progressWrap" class="progress-wrap">
              <div id="progressBar" class="progress-bar"></div>
            </div>
          </article>
        </div>
        <div id="warningBox" class="warning-list hidden"></div>
      </section>

      <section class="panel">
        <h2>Indicateurs</h2>
        <div class="kpi-grid">
          <article class="kpi-card">
            <h3>Factures</h3>
            <p id="invoiceCount">0</p>
          </article>
          <article class="kpi-card">
            <h3>Lignes fichier</h3>
            <p id="lineCount">0</p>
          </article>
          <article class="kpi-card">
            <h3>Anomalies</h3>
            <p id="issuesCount">0</p>
          </article>
        </div>
      </section>

      <section class="panel">
        <h2>Telechargements</h2>
        <div class="downloads">
          <a id="downloadExcel" class="dl-btn disabled" href="#" aria-disabled="true">Excel</a>
          <a id="downloadPdfFactures" class="dl-btn disabled" href="#" aria-disabled="true">PDF Factures</a>
          <a id="downloadPdfSynthese" class="dl-btn disabled" href="#" aria-disabled="true">PDF Synthese</a>
        </div>
      </section>
    </main>
    <script src="/app.js?v=20260215-1"></script>
  </body>
</html>
